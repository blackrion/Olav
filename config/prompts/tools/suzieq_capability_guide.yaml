_type: prompt
input_variables: []
template: |
  # SuzieQ 工具能力指南
  
  SuzieQ 是一个网络遥测工具，提供历史状态查询和分析能力。
  
  ## 工具组合
  
  **必须先后调用**：
  1. `suzieq_schema_search` - 发现可用表和字段（动态，从 OpenSearch 加载）
  2. `suzieq_query` - 执行实际查询（使用发现的表名）
  
  ## 核心能力
  
  ### 1. 查询方法 (method 参数)
  
  | 方法 | 用途 | 返回值 |
  |------|------|--------|
  | `get` | 获取原始记录 | 详细数据列表 |
  | `summarize` | 统计汇总 | 聚合统计信息 |
  | `unique` | 唯一值列表 | 去重后的值 |
  | `aver` | 断言验证 | 符合/不符合预期的记录 |
  
  ### 2. 时间窗口过滤
  
  - `max_age_hours` 参数控制查询数据的时间范围
  - 默认 24 小时，避免返回过期数据
  - 设为 0 查询全部历史数据（用于趋势分析）
  
  ### 3. 智能过滤
  
  - `hostname`: 按设备过滤（精确匹配）
  - `namespace`: 按命名空间过滤（逻辑分组）
  - `**filters`: 任意字段过滤（需先通过 schema_search 确认字段名）
  
  ### 4. 自动去重
  
  - 自动返回每个实体的**最新状态**
  - 优先返回 `active=True` 的记录
  - 避免时间序列数据重复
  
  ## 高级用法
  
  ### 状态变化检测
  ```
  # 比较两个时间点的状态（需要两次查询）
  1. suzieq_query(table=<表名>, max_age_hours=1)  # 最近 1 小时
  2. suzieq_query(table=<表名>, max_age_hours=24) # 对比 24 小时
  ```
  
  ### 跨表关联分析
  ```
  # 诊断路由问题时，可能需要查询多个相关表
  1. 路由协议邻居表 → 检查邻居状态
  2. 接口表 → 检查链路状态
  3. 路由表 → 检查路由是否正确
  ```
  
  ### 批量设备检查
  ```
  # 不指定 hostname 时，返回所有设备的数据
  suzieq_query(table=<表名>, method="summarize")
  ```
  
  ## 注意事项
  
  - ✅ **只读工具** - 不会修改任何设备配置
  - ✅ **Parquet 存储** - 数据来自本地文件，无网络延迟
  - ⚠️ **字段名大小写敏感** - 使用 schema_search 确认字段名
  - ⚠️ **表名不要猜测** - 始终先用 schema_search 发现
  - ⚠️ **数据延迟** - 取决于采集间隔（通常 60 秒）
